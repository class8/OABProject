<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oab.client.member.dao.MemberDao">
	<select id="securitySelect" parameterType="String"
		resultType="security">
		select mt_id, salt from SECURITY_TBL
		where mt_id=#{mt_id}
	</select>

	<insert id="securityInsert" parameterType="security">
		insert into
		SECURITY_TBL(mt_id, salt)
		values(#{mt_id}, #{salt})
	</insert>

	<delete id="securityDelete" parameterType="String">
		delete from
		SECURITY_TBL
		where mt_id = #{mt_id}
	</delete>
	<!--아이디 찾기위한 select -->
	<select id="memberIdselect" parameterType="String"
		resultType="member">
		select mt_id, mt_email
		from MEMBER_TBL
		where mt_email =
		#{mt_email} and mt_name = #{mt_name}
	</select>

	<select id="memberSelect" parameterType="String"
		resultType="member">
		select mt_number, mt_id, mt_pw, mt_name, mt_birth,
		mt_gender, mt_email, mt_phone
		from MEMBER_TBL
		where mt_id = #{mt_id}
	</select>

	<!-- <update id="memberPwUpdate" parameterType="member"> update member_tbl 
		set mt_pw=#{mt_pw} where mt_number=#{mt_number} </update> -->

	<insert id="memberInsert" parameterType="member">

		<selectKey keyProperty="mt_number" resultType="int"
			order="BEFORE">
			select
			MEMBER_SEQ.nextval from dual
		</selectKey>
		insert into MEMBER_TBL(mt_number, mt_id, mt_pw, mt_name, mt_birth,
		mt_gender, mt_email,
		mt_phone, mt_disabled)
		values(#{mt_number}, #{mt_id}, #{mt_pw},
		#{mt_name}, #{mt_birth}, #{mt_gender}, #{mt_email}, #{mt_phone}, 'able')
	</insert>

	<update id="memberUpdate" parameterType="member">
		update MEMBER_TBL set
		<if test="mt_pw != null and mt_pw != ''">
			mt_pw=#{mt_pw},
		</if>
		mt_name=#{mt_name}, mt_birth=#{mt_birth}, mt_gender=#{mt_gender},
		mt_email=#{mt_email}, mt_phone=#{mt_phone}
		where mt_id=#{mt_id}
	</update>

<!-- 	<update id="memberSecede" parameterType="member">
		update MEMBER_TBL set
		mt_MT_DISABLED=#{MT_DISABLED}
		where mt_id=#{mt_id}
	</update> -->


	<update id="memberSecede" parameterType="member">
		update MEMBER_TBL set
		mt_DISABLED = 'disable'
		where mt_id=#{mt_id}
	</update>

	<update id="memberPwUpdate" parameterType="member">
		update MEMBER_TBL set
		mt_pw=#{mt_pw}
		where mt_id=#{mt_id}
	</update>

	<update id="securityPwUpdate" parameterType="member">
		update security_tbl
		set
		salt=#{salt}
		where mt_id=#{mt_id}
	</update>

</mapper>
